{% extends "layouts/base.njk" %}

{% block skipLink %}
{% endblock %}

{% block header %}
{% endblock %}

{% block main %}
  {# <pre>{{sections|dump(1)}}</pre> #}
  <div class="govuk-!-padding-5">

    {% if move.to_location.location_type == 'court' %}
      <section class="app-!-position-relative">
        <h2 class="govuk-heading-m govuk-!-margin-bottom-3 govuk-!-padding-top-2 app-border-top-2 app-border--black">
          {{ t("assessment::heading.text", {
            context: "court"
          }) }}
        </h2>

        {% if move.from_location.location_type == 'prison' and not courtSummary.rows.length %}
          {% if courtHearings.length %}
            {% for courtHearing in courtHearings %}
              {% if courtHearings.length > 1 %}
                <h3 class="govuk-heading-s govuk-!-margin-bottom-2 govuk-!-margin-top-6">
                  {{ t("moves::detail.court_hearings.subheading", {
                    context: "with_index",
                    index: loop.index
                  }) }}
                </h3>
              {% endif %}

              {{ govukSummaryList(courtHearing.summaryList) }}

              {% if not courtHearing.saved_to_nomis %}
                {{ govukWarningText({
                  text: t("moves::detail.court_hearings.nomis_failed", {
                    context: "with_index" if courtHearings.length > 1,
                    index: loop.index
                  }),
                  iconFallbackText: "Warning"
                }) }}
              {% endif %}
            {% endfor %}
          {% else %}
            {{ appMessage({
              classes: "app-message--muted",
              allowDismiss: false,
              content: {
                html: t("moves::detail.court_hearings.empty")
              }
            }) }}
          {% endif %}
        {% else %}
          {% if courtSummary.rows | length %}
            {{ govukSummaryList(courtSummary) }}
          {% else %}
            {{ appMessage({
              classes: "app-message--muted",
              allowDismiss: false,
              content: {
                html: t("assessment::no_items.text", {
                  context: "court"
                })
              }
            }) }}
          {% endif %}
        {% endif %}
      </section>
    {% endif %}

    <section class="app-!-position-relative">
      <h2 class="govuk-heading-m govuk-!-margin-bottom-3 govuk-!-padding-top-2 app-border-top-2 app-border--black">
        {{ t("moves::steps.personal_details.heading") }}
      </h2>

      {{ govukSummaryList(personalDetailsSummary) }}
    </section>

    {% for section in sections %}
      <section class="app-!-position-relative govuk-!-margin-bottom-7">
        <h2 class="govuk-heading-m govuk-!-margin-bottom-3 govuk-!-padding-top-2 app-border-top-2 app-border--black">
          {{ section.name }}
        </h2>

        {% for key, step in section.summarySteps %}
          <section class="app-!-position-relative govuk-!-margin-bottom-3">
            <h3 class="govuk-heading-s govuk-!-margin-bottom-0 govuk-!-padding-bottom-1 app-border-bottom-1">
              {{ step.pageTitle }}
            </h3>

            {{ govukSummaryList(step.summaryListComponent) }}
          </section>
        {% endfor %}
      </section>
    {% endfor %}
  </div>
{% endblock %}

{% block footer %}
{% endblock %}
