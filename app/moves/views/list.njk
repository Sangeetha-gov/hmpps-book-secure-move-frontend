{% extends "./_layout.njk" %}

{% block headerActions %}
  {% if canAccess('move:create') %}
    {{ govukButton({
      isStartButton: true,
      text: t("actions::create_move"),
      href: "/move/new",
      classes: "govuk-!-margin-top-2 app-print--hide"
    }) }}
  {% endif %}
{% endblock %}

{% block headerNav %}
  <div class="govuk-grid-column-one-third">
    <ul class="govuk-list govuk-!-font-size-16 app-!-float-right app-print--hide">
      {% if canAccess('moves:download:all') or canAccess('moves:download:by_location') %}
        <li>
          <a href="{{ REQUEST_PATH }}/download.csv?move-date={{ moveDate }}">
            {{ t("actions::download_csv") }}
          </a>
        </li>
      {% endif %}

      <li>
        <a href="javascript:window.print()">
          {{ t("actions::print_move_list") }}
        </a>
      </li>
    </ul>
  </div>
{% endblock %}

{% block pageContent %}
  {% for destination in destinations %}
    <div class="
      govuk-!-margin-top-7
      app-border-top-2
      app-border--black
      ">
      <div class="govuk-!-padding-top-2 govuk-!-padding-bottom-2">
        {{ appData({
          inverted: true,
          classes: "app-data--s",
          label: t("moves::dashboard.move_to"),
          value: destination.location
        }) }}
      </div>

      {% for move in destination.items %}
        {{ appCard(move) }}
      {% endfor %}
    </div>
  {% else %}
    {{ appMessage({
      classes: "app-message--muted govuk-!-margin-top-7",
      allowDismiss: false,
      content: {
        html: t("moves::dashboard.no_results")
      }
    }) }}
  {% endfor %}

  {% if cancelledMoves.length %}
    <div class="govuk-!-margin-top-9">
      {% set cancelledMovesHtml %}
        {% for cancelledMove in cancelledMoves %}
          {{ appCard(cancelledMove) }}
        {% endfor %}
      {% endset %}

      {{ govukDetails({
        html: cancelledMovesHtml,
        summaryText: t("moves::dashboard.cancelled_moves", {
          count: cancelledMoves.length
        })
      }) }}
    </div>
  {% endif %}
{% endblock %}
